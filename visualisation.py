#!/usr/bin/env python
'''
this script will visualise the results to the user and tell the user that the file
is malicious or not.
'''
import sqlite3

def visual(path):                   #show the required values to the user
    conne =sqlite3.connect(path)
    t = conne.cursor()
    t.execute('SELECT id,name,extension,Dtime,path FROM logs ORDER BY id DESC LIMIT 1')
    for r in t:                     #show the name,extension,datetime,path
        print '\nName: '+str(r[1])+'\nExtension: '+str(r[2])+'\nDate-time: '+str(r[3])+'\nPath: '+str(r[4])

    t.execute('SELECT id,SHA256,Total,Positives FROM vtclassification ORDER BY id desc LIMIT 1')
    for i in t:                     #show the number of antivirus scans and the number of  positive ones
        print '\nTotal Scans of AntiViruses: '+str(i[2])+'\nPositives for Malware: '+str(i[3])
        var = i[3]

    t.close()
    conne.close()
    if var != 0:                    #show the file is malicious or not
        print 'MALICIOUS FILE'
    else:
        print 'NOT MALICIOUS'
    return()
